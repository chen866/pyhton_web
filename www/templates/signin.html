{% extends '__base__.html' %}

{% block title %}注册{% endblock %}

{% block beforehead %}
<script>
    $(function () {
        var vmAuth = new Vue({
            el: '#vm',
            data: {
                email: '',
                password: ''
            },
            methods: {
                submit: function (event) {
                    event.preventDefault();
                    var
                        $form = $('#vm'),
                        email = this.email.trim().toLowerCase(),
                        data = {
                            email: email,
                            password: this.password === '' ? '' : CryptoJS.SHA1(email + ':' + this.password).toString()
                        };
                    $form.postJSON('/api/authenticate', data, function (err, result) {
                        if (!err) {
                            location.assign('/');
                        }
                    });
                }
            }
        });
    });
</script>

{% endblock %}

{% block content %}

<div class="uk-width-2-3 uk-align-center">
    <h1>欢迎登录！</h1>
    <form id="vm" v-on="submit: submit" class="uk-form uk-form-stacked">
        <div class="uk-alert uk-alert-danger uk-hidden uk-width-1-1"></div>
        <div class="uk-form-row uk-form-icon uk-width-1-1">
            <i class="uk-icon-envelope-o"></i>
            <input v-model="email" type="text" placeholder="电子邮件" maxlength="50" class="uk-form-width-1-1 uk-form-large"/>
        </div>
        <div class="uk-form-row uk-form-icon uk-width-1-1">
            <i class="uk-icon-lock"></i>
            <input v-model="password" name="password" type="password" placeholder="口令" maxlength="50" class="uk-form-width-1-1 uk-form-large"/>
        </div>
        <div class="uk-form-row">
            <button type="submit" class="uk-form-width-1-1 uk-button uk-button-primary uk-button-large"><i class="uk-icon-signin-in"></i>登录
            </button>
            
        </div>
    </form>
</div>
{% endblock %}